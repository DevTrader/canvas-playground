{"version":3,"sources":["utility/canvasState.js","scriptV2.js"],"names":["Test","data","console","log","test","bind","alert","initSmartContainerCanvas","canvas","width","height","ctx","getContext","valid","shapes","dragging","selection","dragoffx","dragoffy","wasAnchorHit","draggingResizer","resizerRadius","anchorId","self","getMouse","draw","addShape","clear","drawSingleAnchor","anchorHitIdentifier","avoidNegative","addEventListener","e","preventDefault","mouse","mx","x","my","y","l","length","i","w","hitAreaExtension","h","mySel","anchorHit","selectionColor","selectionWidth","interval","setInterval","shape","strokeStyle","lineWidth","strokeRect","element","offsetX","offsetY","offsetParent","undefined","offsetLeft","offsetTop","pageX","pageY","pi2","Math","PI","side","fillStyle","fill","rr","dx","dy","push","clearRect","rectShape","fillRect","targetCanvas","document","getElementById","myCanvas","canvasState","stage"],"mappings":"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","file":"scriptV2.f02b7b0c.map","sourceRoot":"..","sourcesContent":["class Test {\r\n\tconstructor(data) {\r\n\t\tconsole.log(data);\r\n\t\tthis.data = data;\r\n\r\n\t\tthis.test = this.test.bind(this);\r\n\t}\r\n\ttest() {\r\n\t\talert(this.data);\r\n\t}\r\n}\r\n\r\nexport default {\r\n\tinitSmartContainerCanvas: class CanvasState {\r\n\t\tconstructor(canvas, width, height) {\r\n\t\t\t//Setup\r\n\t\t\tthis.canvas = canvas;\r\n\t\t\tthis.canvas.width = width;\r\n\t\t\tthis.canvas.height = height;\r\n\t\t\tthis.ctx = canvas.getContext(\"2d\");\r\n\r\n\t\t\t//State\r\n\t\t\tthis.valid = false;\r\n\t\t\tthis.shapes = [];\r\n\t\t\tthis.dragging = false;\r\n\t\t\tthis.selection = null;\r\n\t\t\tthis.dragoffx = 0;\r\n\t\t\tthis.dragoffy = 0;\r\n\t\t\tthis.wasAnchorHit = false;\r\n\t\t\tthis.draggingResizer = null;\r\n\t\t\tthis.resizerRadius = 16;\r\n\t\t\tthis.anchorId = null;\r\n\r\n\t\t\t//Backup of self reference\r\n\t\t\tconst self = this;\r\n\r\n\t\t\t//binding (no class properties on parcel)\r\n\t\t\tthis.getMouse = this.getMouse.bind(this);\r\n\t\t\tthis.draw = this.draw.bind(this);\r\n\t\t\tthis.addShape = this.addShape.bind(this);\r\n\t\t\tthis.clear = this.clear.bind(this);\r\n\t\t\tthis.drawSingleAnchor = this.drawSingleAnchor.bind(this);\r\n\t\t\tthis.anchorHitIdentifier = this.anchorHitIdentifier.bind(this);\r\n\t\t\tthis.avoidNegative = this.avoidNegative.bind(this);\r\n\r\n\t\t\t//Prevents user from accidentally selecting (\"highlighting\") elements with mouse.\r\n\t\t\tthis.canvas.addEventListener(\"selectstart\", function(e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t});\r\n\r\n\t\t\tthis.canvas.addEventListener(\r\n\t\t\t\t\"mousedown\",\r\n\t\t\t\tfunction(e) {\r\n\t\t\t\t\t//lost reference of this example\r\n\r\n\t\t\t\t\t//gets mouse position\r\n\t\t\t\t\tconst mouse = self.getMouse(e);\r\n\t\t\t\t\tconst mx = mouse.x;\r\n\t\t\t\t\tconst my = mouse.y;\r\n\t\t\t\t\tconst shapes = self.shapes;\r\n\r\n\t\t\t\t\tconst l = shapes.length;\r\n\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t\t//Loop through created elements (shapes) and check if they are in the mouse position.\r\n\t\t\t\t\tfor (let i = l - 1; i >= 0; i--) {\r\n\t\t\t\t\t\tconsole.log(\"[SCREENER]\", shapes[i].x + shapes[i].w >= mx);\r\n\t\t\t\t\t\t//If the mouse pos is within the element x position + its width AND element y position + its height, it is selected, prioritizes the one on \"top\" (last added element)\r\n\t\t\t\t\t\t//Added 8 in order to extend hit area to anchor points\r\n\t\t\t\t\t\tconst hitAreaExtension = self.resizerRadius/2\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (shapes[i].x - hitAreaExtension <= mx && shapes[i].x + hitAreaExtension + shapes[i].w >= mx && shapes[i].y - hitAreaExtension <= my && shapes[i].y + hitAreaExtension + shapes[i].h >= my) {\r\n\t\t\t\t\t\t\t//Set state accordingly\r\n\t\t\t\t\t\t\tconst mySel = shapes[i];\r\n\t\t\t\t\t\t\tconsole.log(\"[SELECTED]\", mySel);\r\n\r\n\t\t\t\t\t\t\t// alert(JSON.stringify(mySel))\r\n\t\t\t\t\t\t\t//Create smooth dragging\r\n\t\t\t\t\t\t\tself.dragoffx = mx - mySel.x;\r\n\t\t\t\t\t\t\tself.dragoffy = my - mySel.y;\r\n\t\t\t\t\t\t\tself.dragging = true;\r\n\t\t\t\t\t\t\tself.selection = mySel;\r\n\t\t\t\t\t\t\tself.valid = false;\r\n\r\n\t\t\t\t\t\t\tconst anchorHit = self.anchorHitIdentifier(mx, my);\r\n\r\n\t\t\t\t\t\t\tif(anchorHit > -1){\r\n\t\t\t\t\t\t\t\tself.wasAnchorHit = true\r\n\t\t\t\t\t\t\t\tself.anchorId = anchorHit\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tself.wasAnchorHit = false\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tconsole.log('ANCHOR',anchorHit)\r\n\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//Detect anchor hit\r\n\t\t\t\t\t/**\r\n\t\t\t\t\t * Where does the anchor start and end?\r\n\t\t\t\t\t * \r\n\t\t\t\t\t */\r\n\r\n\r\n\t\t\t\t\tif (self.selection && self.wasAnchorHit) {\r\n\t\t\t\t\t\t//may not be necessary\r\n\t\t\t\t\t\tself.dragging = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//Deselect old selected object;\r\n\t\t\t\t\tif (self.selection && !self.wasAnchorHit) {\r\n\t\t\t\t\t\tself.selection = null;\r\n\t\t\t\t\t\tself.valid = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\ttrue\r\n\t\t\t);\r\n\r\n\t\t\tthis.canvas.addEventListener(\r\n\t\t\t\t\"mousemove\",\r\n\t\t\t\tfunction(e) {\r\n\t\t\t\t\t//Shape drag\r\n\t\t\t\t\tif (self.dragging && !self.wasAnchorHit) {\r\n\t\t\t\t\t\tconst mouse = self.getMouse(e);\r\n\t\t\t\t\t\t//Drag elementfrom where it was clicked;\r\n\t\t\t\t\t\tconsole.log(\"[DRAGGING]\", self.dragoffx);\r\n\t\t\t\t\t\tself.selection.x = mouse.x - self.dragoffx;\r\n\t\t\t\t\t\tself.selection.y = mouse.y - self.dragoffy;\r\n\t\t\t\t\t\tself.valid = false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//Anchor drag handler\r\n\r\n\t\t\t\t\t/**\r\n\t\t\t\t\t * TO DO: HANDLE THE CONDITIONALS MORE GRACEFULLY, should position lock? Try getting their width bellow 0 from both sides\r\n\t\t\t\t\t */\r\n\t\t\t\t\tif (self.dragging && self.wasAnchorHit) {\r\n\t\t\t\t\t\tconst mouse = self.getMouse(e);\r\n\t\t\t\t\t\tself.valid = false;\r\n\t\t\t\t\t\tswitch(self.anchorId){\r\n\t\t\t\t\t\t\tcase 0: //top-left\r\n\t\t\t\t\t\t\t\tself.selection.w = (((self.selection.x + self.selection.w) - mouse.x) < 0) ? 1 : (self.selection.x + self.selection.w) - mouse.x;\r\n\t\t\t\t\t\t\t\tself.selection.h = (((self.selection.y + self.selection.h) - mouse.y) < 0) ? 1 : (self.selection.y + self.selection.h) - mouse.y;\r\n\t\t\t\t\t\t\t\tself.selection.x =  mouse.x ;\r\n\t\t\t\t\t\t\t\tself.selection.y =  mouse.y ;\r\n\t\t\t\t\t\t\tconsole.log('[SELF SELECT]', self.dragoffx, mouse.x , self.selection)\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 1: //top-right\r\n\t\t\t\t\t\t\t\tself.selection.w = ((mouse.x - self.selection.x) < 0) ? 1 : mouse.x - self.selection.x;\r\n\t\t\t\t\t\t\t\tself.selection.h = (((self.selection.y + self.selection.h) - mouse.y) < 0) ? 1 : (self.selection.y + self.selection.h) - mouse.y;\r\n\t\t\t\t\t\t\t\tself.selection.y = mouse.y ;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 2: //bottom-right\r\n\t\t\t\t\t\t\t\tself.selection.w = ((mouse.x - self.selection.x) < 0) ? 1 : mouse.x - self.selection.x;\r\n\t\t\t\t\t\t\t\tself.selection.h = ((mouse.y - self.selection.y) < 0) ? 1 : mouse.y - self.selection.y;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 3: //bottom-left\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tself.selection.h = ((mouse.y - self.selection.y) < 0) ? 1 : mouse.y - self.selection.y;\r\n\t\t\t\t\t\t\t\tself.selection.w = (((self.selection.x + self.selection.w) - mouse.x) < 0)? 1: (self.selection.x + self.selection.w) - mouse.x;\r\n\t\t\t\t\t\t\t\tself.selection.x =  mouse.x ;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\ttrue\r\n\t\t\t);\r\n\r\n\t\t\tthis.canvas.addEventListener(\r\n\t\t\t\t\"mouseup\",\r\n\t\t\t\tfunction(e) {\r\n\t\t\t\t\tself.dragging = false;\r\n\t\t\t\t\tself.wasAnchorHit = false;\r\n\t\t\t\t},\r\n\t\t\t\ttrue\r\n\t\t\t);\r\n\r\n\t\t\t//Selection options and draw frequency (30ms)\r\n\t\t\t//SELECTION OPTIONS ARE NOT ADDED YET\r\n\r\n\t\t\tthis.selectionColor = \"#CC0000\";\r\n\t\t\tthis.selectionWidth = 2;\r\n\t\t\tthis.interval = 17;\r\n\t\t\tsetInterval(this.draw, this.interval);\r\n\t\t}\r\n\r\n\t\tdraw() {\r\n\t\t\t// if our state is invalid, redraw and validate!\r\n\t\t\tif (!this.valid) {\r\n\t\t\t\tconst ctx = this.canvas.getContext(\"2d\");\r\n\t\t\t\tconst shapes = this.shapes;\r\n\t\t\t\tthis.clear();\r\n\r\n\t\t\t\t// draw all shapes\r\n\t\t\t\tconst l = shapes.length;\r\n\t\t\t\tfor (var i = 0; i < l; i++) {\r\n\t\t\t\t\tconst shape = shapes[i];\r\n\t\t\t\t\t// We can skip the drawing of elements that have moved off the screen:\r\n\t\t\t\t\tif (shape.x > this.width || shape.y > this.height || shape.x + shape.w < 0 || shape.y + shape.h < 0) continue;\r\n\t\t\t\t\tshapes[i].draw(ctx);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// draw selection\r\n\t\t\t\t// right now this is just a stroke along the edge of the selected Shape\r\n\t\t\t\tif (this.selection != null) {\r\n\t\t\t\t\tctx.strokeStyle = this.selectionColor;\r\n\t\t\t\t\tctx.lineWidth = this.selectionWidth;\r\n\t\t\t\t\tconst mySel = this.selection;\r\n\t\t\t\t\t//Draw selection border\r\n\t\t\t\t\tctx.strokeRect(mySel.x, mySel.y, mySel.w, mySel.h);\r\n\r\n\t\t\t\t\t//DRAW ANCHORS (NEED HIT DETECTION)\r\n\t\t\t\t\tthis.drawSingleAnchor(mySel.x, mySel.y)\r\n\t\t\t\t\tthis.drawSingleAnchor((mySel.x + mySel.w), mySel.y)\r\n\t\t\t\t\tthis.drawSingleAnchor((mySel.x + mySel.w), (mySel.y + mySel.h))\r\n\t\t\t\t\tthis.drawSingleAnchor(mySel.x, (mySel.y + mySel.h))\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// ** Add stuff you want drawn on top all the time here **\r\n\r\n\t\t\t\tthis.valid = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tgetMouse(e) {\r\n\t\t\tvar element = this.canvas,\r\n\t\t\t\toffsetX = 0,\r\n\t\t\t\toffsetY = 0,\r\n\t\t\t\tmx,\r\n\t\t\t\tmy;\r\n\r\n\t\t\t// Compute the total offset\r\n\t\t\tif (element.offsetParent !== undefined) {\r\n\t\t\t\tdo {\r\n\t\t\t\t\toffsetX += element.offsetLeft;\r\n\t\t\t\t\toffsetY += element.offsetTop;\r\n\t\t\t\t} while ((element = element.offsetParent));\r\n\t\t\t}\r\n\r\n\t\t\t// Add padding and border style widths to offset\r\n\t\t\t// Also add the offsets in case there's a position:fixed bar\r\n\t\t\t// offsetX += this.stylePaddingLeft + this.styleBorderLeft + this.htmlLeft;\r\n\t\t\t// offsetY += this.stylePaddingTop + this.styleBorderTop + this.htmlTop;\r\n\r\n\t\t\tmx = e.pageX - offsetX;\r\n\t\t\tmy = e.pageY - offsetY;\r\n\t\t\tconsole.log(\"[MOUSE STUFF]\", { x: mx, y: my });\r\n\t\t\t// We return a simple javascript object (a hash) with x and y defined\r\n\t\t\treturn { x: mx, y: my };\r\n\t\t}\r\n\r\n\t\tdrawSingleAnchor(x,y){\r\n\t\t\tconst ctx = this.canvas.getContext(\"2d\");\r\n\t\t\tconst pi2=Math.PI*2;\r\n\t\t\tconst side = this.resizerRadius;\r\n\r\n\t\t\tctx.fillStyle = '#fff';\r\n\t\t\tctx.fill();\r\n\r\n\t\t\tctx.strokeStyle = '#000';\r\n\t\t\tctx.lineWidth = this.selectionWidth;\r\n\t\t\t//Draw Anchor border\r\n\t\t\tctx.strokeRect(x - (side/2), y  - (side/2), side, side);\r\n\r\n\r\n\t\t\t//ctx.fillRect(x - (side/2), y  - (side/2), side, side, 0, 0, false);\r\n\t\t}\r\n\r\n\t\tanchorHitIdentifier(x,y){\r\n\t\t\tconst mySel = this.selection;\r\n\t\t\tconst rr = this.resizerRadius * this.resizerRadius;\r\n\t\t\tlet dx,dy;\r\n\t\r\n\t\t\t// top-left\r\n\t\t\tdx=x-mySel.x;\r\n\t\t\tdy=y-mySel.y;\r\n\t\t\tif(dx*dx+dy*dy<=rr){ return(0); }\r\n\t\t\t// top-right\r\n\t\t\tdx=x-(mySel.x + mySel.w);\r\n\t\t\tdy=y-mySel.y;\r\n\t\t\tif(dx*dx+dy*dy<=rr){ return(1); }\r\n\t\t\t// bottom-right\r\n\t\t\tdx=x-(mySel.x + mySel.w);\r\n\t\t\tdy=y-(mySel.y + mySel.h);\r\n\t\t\tif(dx*dx+dy*dy<=rr){ return(2); }\r\n\t\t\t// bottom-left\r\n\t\t\tdx=x-mySel.x;\r\n\t\t\tdy=y-(mySel.y + mySel.h);\r\n\t\t\tif(dx*dx+dy*dy<=rr){ return(3); }\r\n\t\t\treturn(-1);\r\n\t\r\n\t\t}\r\n\r\n\t\taddShape(shape) {\r\n\t\t\tthis.shapes.push(shape);\r\n\t\t\tconsole.log(this.shapes);\r\n\t\t}\r\n\r\n\t\t//this avoids ghosting, but it needs to change.\r\n\t\t//it needs to clear the \"old frames\"\r\n\t\tclear() {\r\n\t\t\tconst ctx = this.canvas.getContext(\"2d\");\r\n\t\t\t//When should this be cleared?\r\n\t\t\tctx.clearRect(0, 0, this.canvas.width, this.canvas.width);\r\n\t\t\t// this.canvas.width = window.innerWidth;\r\n\t\t\t// this.canvas.height = window.innerHeight;\r\n\t\t}\r\n\r\n\t\tavoidNegative(){\r\n\t\t\tif(self.selection.w <= 0){\r\n\t\t\t\tself.selection.w = 10;\r\n\t\t\t}\r\n\t\t\tif(self.selection.h <= 0){\r\n\t\t\t\tself.selection.h = 10;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\trectShape: class Shape {\r\n\t\tconstructor(x, y, w, h, fill) {\r\n\t\t\tthis.x = x || 0;\r\n\t\t\tthis.y = y || 0;\r\n\t\t\tthis.w = w || 0;\r\n\t\t\tthis.h = h || 0;\r\n\t\t\tthis.fill = fill || \"#000\";\r\n\r\n\t\t\tthis.draw = this.draw.bind(this);\r\n\t\t}\r\n\t\tdraw(ctx) {\r\n\t\t\tctx.fillStyle = this.fill;\r\n\t\t\tctx.fillRect(this.x, this.y, this.w, this.h);\r\n\t\t}\r\n\t}\r\n};\r\n","import canvasState from './utility/canvasState';\r\n\r\n/**\r\n * Objective: \r\n *   1-Refactor script.js into stateful canvas pattern.\r\n *   2-Get selection and anchors working properly\r\n *   3-Initiate react structure (or utility functions)\r\n */\r\n\r\nconst targetCanvas = document.getElementById(\"canvas\")\r\n\r\nconst myCanvas = new canvasState.initSmartContainerCanvas(targetCanvas, 1500, 900)\r\n\r\nconsole.log('active')\r\n// const test = new canvasState.Test('DATA');\r\n\r\nmyCanvas.addShape(new canvasState.rectShape(530,700,240,160, 'green'))\r\nmyCanvas.addShape(new canvasState.rectShape(240,40,60,50));\r\nmyCanvas.addShape(new canvasState.rectShape(880,150,160,130, 'rgba(127, 255, 212, .5)'));\r\nmyCanvas.addShape(new canvasState.rectShape(280,10,13,400, 'red'));\r\n\r\n\r\nconsole.log('[STAGE]', stage)\r\n"]}