{"version":3,"sources":["utility/canvasState.js","scriptV2.js"],"names":["Test","data","console","log","test","bind","alert","initSmartContainerCanvas","canvas","width","height","ctx","getContext","valid","shapes","dragging","selection","dragoffx","dragoffy","wasAnchorHit","draggingResizer","resizerRadius","anchorId","self","getMouse","draw","addShape","clear","drawSingleAnchor","anchorHitIdentifier","addEventListener","e","preventDefault","mouse","mx","x","my","y","l","length","i","w","h","mySel","anchorHit","selectionColor","selectionWidth","interval","setInterval","shape","strokeStyle","lineWidth","strokeRect","element","offsetX","offsetY","offsetParent","undefined","offsetLeft","offsetTop","pageX","pageY","pi2","Math","PI","beginPath","arc","closePath","fillStyle","fill","rr","dx","dy","push","clearRect","rectShape","fillRect","targetCanvas","document","getElementById","myCanvas","canvasState","stage"],"mappings":"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","file":"scriptV2.f02b7b0c.map","sourceRoot":"..","sourcesContent":["class Test {\r\n\tconstructor(data) {\r\n\t\tconsole.log(data);\r\n\t\tthis.data = data;\r\n\r\n\t\tthis.test = this.test.bind(this);\r\n\t}\r\n\ttest() {\r\n\t\talert(this.data);\r\n\t}\r\n}\r\n\r\nexport default {\r\n\tinitSmartContainerCanvas: class CanvasState {\r\n\t\tconstructor(canvas, width, height) {\r\n\t\t\t//Setup\r\n\t\t\tthis.canvas = canvas;\r\n\t\t\tthis.canvas.width = width;\r\n\t\t\tthis.canvas.height = height;\r\n\t\t\tthis.ctx = canvas.getContext(\"2d\");\r\n\r\n\t\t\t//State\r\n\t\t\tthis.valid = false;\r\n\t\t\tthis.shapes = [];\r\n\t\t\tthis.dragging = false;\r\n\t\t\tthis.selection = null;\r\n\t\t\tthis.dragoffx = 0;\r\n\t\t\tthis.dragoffy = 0;\r\n\t\t\tthis.wasAnchorHit = false;\r\n\t\t\tthis.draggingResizer = null;\r\n\t\t\tthis.resizerRadius = 8;\r\n\t\t\tthis.anchorId = null;\r\n\r\n\t\t\t//Backup of self reference\r\n\t\t\tconst self = this;\r\n\r\n\t\t\t//binding (no class properties on parcel)\r\n\t\t\tthis.getMouse = this.getMouse.bind(this);\r\n\t\t\tthis.draw = this.draw.bind(this);\r\n\t\t\tthis.addShape = this.addShape.bind(this);\r\n\t\t\tthis.clear = this.clear.bind(this);\r\n\t\t\tthis.drawSingleAnchor = this.drawSingleAnchor.bind(this);\r\n\t\t\tthis.anchorHitIdentifier = this.anchorHitIdentifier.bind(this);\r\n\r\n\t\t\t//Prevents user from accidentally selecting (\"highlighting\") elements with mouse.\r\n\t\t\tthis.canvas.addEventListener(\"selectstart\", function(e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t});\r\n\r\n\t\t\tthis.canvas.addEventListener(\r\n\t\t\t\t\"mousedown\",\r\n\t\t\t\tfunction(e) {\r\n\t\t\t\t\t//lost reference of this example\r\n\r\n\t\t\t\t\t//gets mouse position\r\n\t\t\t\t\tconst mouse = self.getMouse(e);\r\n\t\t\t\t\tconst mx = mouse.x;\r\n\t\t\t\t\tconst my = mouse.y;\r\n\t\t\t\t\tconst shapes = self.shapes;\r\n\r\n\t\t\t\t\tconst l = shapes.length;\r\n\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t\t//Loop through created elements (shapes) and check if they are in the mouse position.\r\n\t\t\t\t\tfor (let i = l - 1; i >= 0; i--) {\r\n\t\t\t\t\t\tconsole.log(\"[SCREENER]\", shapes[i].x + shapes[i].w >= mx);\r\n\t\t\t\t\t\t//If the mouse pos is within the element x position + its width AND element y position + its height, it is selected, prioritizes the one on \"top\" (last added element)\r\n\t\t\t\t\t\tif (shapes[i].x - 8 <= mx && shapes[i].x + 8 + shapes[i].w >= mx && shapes[i].y - 8 <= my && shapes[i].y + 8 + shapes[i].h >= my) {\r\n\t\t\t\t\t\t\t//Set state accordingly\r\n\t\t\t\t\t\t\tconst mySel = shapes[i];\r\n\t\t\t\t\t\t\tconsole.log(\"[SELECTED]\", mySel);\r\n\r\n\t\t\t\t\t\t\t// alert(JSON.stringify(mySel))\r\n\t\t\t\t\t\t\t//Create smooth dragging\r\n\t\t\t\t\t\t\tself.dragoffx = mx - mySel.x;\r\n\t\t\t\t\t\t\tself.dragoffy = my - mySel.y;\r\n\t\t\t\t\t\t\tself.dragging = true;\r\n\t\t\t\t\t\t\tself.selection = mySel;\r\n\t\t\t\t\t\t\tself.valid = false;\r\n\r\n\t\t\t\t\t\t\tconst anchorHit = self.anchorHitIdentifier(mx, my);\r\n\r\n\t\t\t\t\t\t\tif(anchorHit > -1){\r\n\t\t\t\t\t\t\t\tself.wasAnchorHit = true\r\n\t\t\t\t\t\t\t\tself.anchorId = anchorHit\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tself.wasAnchorHit = false\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tconsole.log('ANCHOR',anchorHit)\r\n\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//Detect anchor hit\r\n\t\t\t\t\t/**\r\n\t\t\t\t\t * Where does the anchor start and end?\r\n\t\t\t\t\t * \r\n\t\t\t\t\t */\r\n\r\n\r\n\t\t\t\t\tif (self.selection && self.wasAnchorHit) {\r\n\t\t\t\t\t\t//may not be necessary\r\n\t\t\t\t\t\tself.dragging = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//Deselect old selected object;\r\n\t\t\t\t\tif (self.selection && !self.wasAnchorHit) {\r\n\t\t\t\t\t\tself.selection = null;\r\n\t\t\t\t\t\tself.valid = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\ttrue\r\n\t\t\t);\r\n\r\n\t\t\tthis.canvas.addEventListener(\r\n\t\t\t\t\"mousemove\",\r\n\t\t\t\tfunction(e) {\r\n\t\t\t\t\tif (self.dragging && !self.wasAnchorHit) {\r\n\t\t\t\t\t\tconst mouse = self.getMouse(e);\r\n\t\t\t\t\t\t//Drag elementfrom where it was clicked;\r\n\t\t\t\t\t\tconsole.log(\"[DRAGGING]\", self.dragoffx);\r\n\t\t\t\t\t\tself.selection.x = mouse.x - self.dragoffx;\r\n\t\t\t\t\t\tself.selection.y = mouse.y - self.dragoffy;\r\n\t\t\t\t\t\tself.valid = false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (self.dragging && self.wasAnchorHit) {\r\n\t\t\t\t\t\tconst mouse = self.getMouse(e);\r\n\t\t\t\t\t\tself.valid = false;\r\n\t\t\t\t\t\tswitch(self.anchorId){\r\n\t\t\t\t\t\t\tcase 0: //top-left\r\n\t\t\t\t\t\t\t\tself.selection.w = (self.selection.x + self.selection.w) - mouse.x;\r\n\t\t\t\t\t\t\t\tself.selection.h = (self.selection.y + self.selection.h) - mouse.y;\r\n\t\t\t\t\t\t\t\tself.selection.x = mouse.x ;\r\n\t\t\t\t\t\t\t\tself.selection.y = mouse.y ;\r\n\t\t\t\t\t\t\tconsole.log('[SELF SELECT]', self.dragoffx, mouse.x , self.selection)\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 1: //top-right\r\n\t\t\t\t\t\t\t\tself.selection.w = mouse.x - self.selection.x;\r\n\t\t\t\t\t\t\t\tself.selection.h = (self.selection.y + self.selection.h) - mouse.y;\r\n\t\t\t\t\t\t\t\tself.selection.y = mouse.y ;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 2: //bottom-right\r\n\t\t\t\t\t\t\t\tself.selection.w = mouse.x - self.selection.x;\r\n\t\t\t\t\t\t\t\tself.selection.h = mouse.y - self.selection.y;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 3: //bottom-left\r\n\t\t\t\t\t\t\t\tself.selection.h = mouse.y - self.selection.y;\r\n\t\t\t\t\t\t\t\tself.selection.w = (self.selection.x + self.selection.w) - mouse.x;\r\n\t\t\t\t\t\t\t\tself.selection.x = mouse.x ;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\ttrue\r\n\t\t\t);\r\n\r\n\t\t\tthis.canvas.addEventListener(\r\n\t\t\t\t\"mouseup\",\r\n\t\t\t\tfunction(e) {\r\n\t\t\t\t\tself.dragging = false;\r\n\t\t\t\t\tself.wasAnchorHit = false;\r\n\t\t\t\t},\r\n\t\t\t\ttrue\r\n\t\t\t);\r\n\r\n\t\t\t//Selection options and draw frequency (30ms)\r\n\t\t\t//SELECTION OPTIONS ARE NOT ADDED YET\r\n\r\n\t\t\tthis.selectionColor = \"#CC0000\";\r\n\t\t\tthis.selectionWidth = 2;\r\n\t\t\tthis.interval = 17;\r\n\t\t\tsetInterval(this.draw, this.interval);\r\n\t\t}\r\n\r\n\t\tdraw() {\r\n\t\t\t// if our state is invalid, redraw and validate!\r\n\t\t\tif (!this.valid) {\r\n\t\t\t\tconst ctx = this.canvas.getContext(\"2d\");\r\n\t\t\t\tconst shapes = this.shapes;\r\n\t\t\t\tthis.clear();\r\n\r\n\t\t\t\t// draw all shapes\r\n\t\t\t\tconst l = shapes.length;\r\n\t\t\t\tfor (var i = 0; i < l; i++) {\r\n\t\t\t\t\tconst shape = shapes[i];\r\n\t\t\t\t\t// We can skip the drawing of elements that have moved off the screen:\r\n\t\t\t\t\tif (shape.x > this.width || shape.y > this.height || shape.x + shape.w < 0 || shape.y + shape.h < 0) continue;\r\n\t\t\t\t\tshapes[i].draw(ctx);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// draw selection\r\n\t\t\t\t// right now this is just a stroke along the edge of the selected Shape\r\n\t\t\t\tif (this.selection != null) {\r\n\t\t\t\t\tctx.strokeStyle = this.selectionColor;\r\n\t\t\t\t\tctx.lineWidth = this.selectionWidth;\r\n\t\t\t\t\tconst mySel = this.selection;\r\n\t\t\t\t\t//Draw selection border\r\n\t\t\t\t\tctx.strokeRect(mySel.x, mySel.y, mySel.w, mySel.h);\r\n\r\n\t\t\t\t\t//DRAW ANCHORS (NEED HIT DETECTION)\r\n\t\t\t\t\tthis.drawSingleAnchor(mySel.x, mySel.y)\r\n\t\t\t\t\tthis.drawSingleAnchor((mySel.x + mySel.w), mySel.y)\r\n\t\t\t\t\tthis.drawSingleAnchor((mySel.x + mySel.w), (mySel.y + mySel.h))\r\n\t\t\t\t\tthis.drawSingleAnchor(mySel.x, (mySel.y + mySel.h))\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// ** Add stuff you want drawn on top all the time here **\r\n\r\n\t\t\t\tthis.valid = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tgetMouse(e) {\r\n\t\t\tvar element = this.canvas,\r\n\t\t\t\toffsetX = 0,\r\n\t\t\t\toffsetY = 0,\r\n\t\t\t\tmx,\r\n\t\t\t\tmy;\r\n\r\n\t\t\t// Compute the total offset\r\n\t\t\tif (element.offsetParent !== undefined) {\r\n\t\t\t\tdo {\r\n\t\t\t\t\toffsetX += element.offsetLeft;\r\n\t\t\t\t\toffsetY += element.offsetTop;\r\n\t\t\t\t} while ((element = element.offsetParent));\r\n\t\t\t}\r\n\r\n\t\t\t// Add padding and border style widths to offset\r\n\t\t\t// Also add the offsets in case there's a position:fixed bar\r\n\t\t\t// offsetX += this.stylePaddingLeft + this.styleBorderLeft + this.htmlLeft;\r\n\t\t\t// offsetY += this.stylePaddingTop + this.styleBorderTop + this.htmlTop;\r\n\r\n\t\t\tmx = e.pageX - offsetX;\r\n\t\t\tmy = e.pageY - offsetY;\r\n\t\t\tconsole.log(\"[MOUSE STUFF]\", { x: mx, y: my });\r\n\t\t\t// We return a simple javascript object (a hash) with x and y defined\r\n\t\t\treturn { x: mx, y: my };\r\n\t\t}\r\n\r\n\t\tdrawSingleAnchor(x,y){\r\n\t\t\tconst ctx = this.canvas.getContext(\"2d\");\r\n\t\t\tconst pi2=Math.PI*2;\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.arc(x,y,this.resizerRadius,0,pi2,false);\r\n\t\t\tctx.closePath();\r\n\t\t\tctx.fillStyle = '#000';\r\n\t\t\tctx.fill();\r\n\t\t\t// ctx.fillStyle = '#000';\r\n\t\t\t// ctx.fillRect(x, y, 15, 15, 0, 0, false);\r\n\t\t}\r\n\r\n\t\tanchorHitIdentifier(x,y){\r\n\t\t\tconst mySel = this.selection;\r\n\t\t\tconst rr = this.resizerRadius * this.resizerRadius;\r\n\t\t\tlet dx,dy;\r\n\t\r\n\t\t\t// top-left\r\n\t\t\tdx=x-mySel.x;\r\n\t\t\tdy=y-mySel.y;\r\n\t\t\tif(dx*dx+dy*dy<=rr){ return(0); }\r\n\t\t\t// top-right\r\n\t\t\tdx=x-(mySel.x + mySel.w);\r\n\t\t\tdy=y-mySel.y;\r\n\t\t\tif(dx*dx+dy*dy<=rr){ return(1); }\r\n\t\t\t// bottom-right\r\n\t\t\tdx=x-(mySel.x + mySel.w);\r\n\t\t\tdy=y-(mySel.y + mySel.h);\r\n\t\t\tif(dx*dx+dy*dy<=rr){ return(2); }\r\n\t\t\t// bottom-left\r\n\t\t\tdx=x-mySel.x;\r\n\t\t\tdy=y-(mySel.y + mySel.h);\r\n\t\t\tif(dx*dx+dy*dy<=rr){ return(3); }\r\n\t\t\treturn(-1);\r\n\t\r\n\t\t}\r\n\r\n\t\taddShape(shape) {\r\n\t\t\tthis.shapes.push(shape);\r\n\t\t\tconsole.log(this.shapes);\r\n\t\t}\r\n\r\n\t\t//this avoids ghosting, but it needs to change.\r\n\t\t//it needs to clear the \"old frames\"\r\n\t\tclear() {\r\n\t\t\tconst ctx = this.canvas.getContext(\"2d\");\r\n\t\t\t//When should this be cleared?\r\n\t\t\tctx.clearRect(0, 0, this.canvas.width, this.canvas.width);\r\n\t\t\t// this.canvas.width = window.innerWidth;\r\n\t\t\t// this.canvas.height = window.innerHeight;\r\n\t\t}\r\n\t},\r\n\trectShape: class Shape {\r\n\t\tconstructor(x, y, w, h, fill) {\r\n\t\t\tthis.x = x || 0;\r\n\t\t\tthis.y = y || 0;\r\n\t\t\tthis.w = w || 0;\r\n\t\t\tthis.h = h || 0;\r\n\t\t\tthis.fill = fill || \"#000\";\r\n\r\n\t\t\tthis.draw = this.draw.bind(this);\r\n\t\t}\r\n\t\tdraw(ctx) {\r\n\t\t\tctx.fillStyle = this.fill;\r\n\t\t\tctx.fillRect(this.x, this.y, this.w, this.h);\r\n\t\t}\r\n\t}\r\n};\r\n","import canvasState from './utility/canvasState';\r\n\r\n/**\r\n * Objective: \r\n *   1-Refactor script.js into stateful canvas pattern.\r\n *   2-Get selection and anchors working properly\r\n *   3-Initiate react structure (or utility functions)\r\n */\r\n\r\nconst targetCanvas = document.getElementById(\"canvas\")\r\n\r\nconst myCanvas = new canvasState.initSmartContainerCanvas(targetCanvas, 1500, 900)\r\n\r\nconsole.log('active')\r\n// const test = new canvasState.Test('DATA');\r\n\r\nmyCanvas.addShape(new canvasState.rectShape(530,700,240,160, 'green'))\r\nmyCanvas.addShape(new canvasState.rectShape(240,40,60,50));\r\nmyCanvas.addShape(new canvasState.rectShape(880,150,160,130, 'rgba(127, 255, 212, .5)'));\r\nmyCanvas.addShape(new canvasState.rectShape(280,10,13,400, 'red'));\r\n\r\n\r\nconsole.log('[STAGE]', stage)\r\n"]}